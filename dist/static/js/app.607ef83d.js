(function(){"use strict";var e={4764:function(e,t,a){var r=a(3751),o=a(641);const i={id:"app"};function n(e,t,a,r,n,s){const l=(0,o.g2)("AppHeader"),u=(0,o.g2)("router-view");return(0,o.uX)(),(0,o.CE)("div",i,[(0,o.bF)(l),(0,o.bF)(u)])}const s={class:"app-header"},l={class:"header-content"};function u(e,t,a,r,i,n){const u=(0,o.g2)("router-link");return(0,o.uX)(),(0,o.CE)("header",s,[(0,o.Lk)("div",l,[(0,o.Lk)("nav",null,[(0,o.bF)(u,{to:"/"},{default:(0,o.k6)((()=>[(0,o.eW)("Home")])),_:1}),(0,o.bF)(u,{to:"/sitter-search"},{default:(0,o.k6)((()=>[(0,o.eW)("Search")])),_:1}),i.isAuthenticated?((0,o.uX)(),(0,o.Wv)(u,{key:0,to:"/profile"},{default:(0,o.k6)((()=>[(0,o.eW)("Profile")])),_:1})):(0,o.Q3)("",!0),i.isAuthenticated?((0,o.uX)(),(0,o.CE)("button",{key:1,onClick:t[0]||(t[0]=(...e)=>n.logout&&n.logout(...e)),class:"logout-button"},"Logout")):(0,o.Q3)("",!0)])])])}a(4114);var c={name:"AppHeader",data(){return{isAuthenticated:!1}},created(){this.checkAuthentication()},methods:{checkAuthentication(){const e=localStorage.getItem("token");this.isAuthenticated=!!e},logout(){localStorage.removeItem("token"),this.isLoggedIn=!1,this.username="",this.$router.push("/login")}},watch:{$route(){this.checkAuthentication()}}},d=a(6262);const p=(0,d.A)(c,[["render",u],["__scopeId","data-v-3877be8c"]]);var m=p,h={name:"App",components:{AppHeader:m}};const g=(0,d.A)(h,[["render",n]]);var f=g,k=a(5220),v=a(33);const L=e=>((0,o.Qi)("data-v-16a789fa"),e=e(),(0,o.jt)(),e),b={ref:"map",class:"map"},y=L((()=>(0,o.Lk)("h1",null,"シッター検索",-1))),C={class:"input-group"},_=L((()=>(0,o.Lk)("label",{for:"prefecture"},"都道府県",-1))),w=["value"],A={class:"input-group"},T=L((()=>(0,o.Lk)("label",{for:"city"},"市区町村",-1))),S=["value"],P={class:"input-group"},D=L((()=>(0,o.Lk)("label",{for:"startDate"},"開始日",-1))),I={class:"input-group"},E=L((()=>(0,o.Lk)("label",{for:"startTime"},"開始時間",-1))),X={class:"input-group"},U=L((()=>(0,o.Lk)("label",{for:"endDate"},"終了日",-1))),V={class:"input-group"},j=L((()=>(0,o.Lk)("label",{for:"endTime"},"終了時間",-1))),J=L((()=>(0,o.Lk)("button",{type:"submit"},"検索する",-1))),O={key:0,class:"results"},$=L((()=>(0,o.Lk)("h2",null,"検索結果",-1)));function F(e,t,a,i,n,s){return(0,o.uX)(),(0,o.CE)("div",null,[(0,o.Lk)("div",b,null,512),(0,o.Lk)("button",{type:"button",onClick:t[0]||(t[0]=(...e)=>s.getCurrentLocation&&s.getCurrentLocation(...e)),class:"btn-location"},"現在地から検索する"),(0,o.Lk)("button",{onClick:t[1]||(t[1]=(...e)=>s.searchArea&&s.searchArea(...e)),class:"btn-area-search"},"このエリアで検索"),y,(0,o.Lk)("form",{onSubmit:t[9]||(t[9]=(0,r.D$)(((...e)=>s.searchSitters&&s.searchSitters(...e)),["prevent"]))},[(0,o.Lk)("div",C,[_,(0,o.bo)((0,o.Lk)("select",{id:"prefecture","onUpdate:modelValue":t[2]||(t[2]=e=>n.selectedPrefecture=e),onChange:t[3]||(t[3]=(...e)=>s.updateCities&&s.updateCities(...e))},[((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)(n.prefectures,(e=>((0,o.uX)(),(0,o.CE)("option",{key:e.name,value:e.name},(0,v.v_)(e.name),9,w)))),128))],544),[[r.u1,n.selectedPrefecture]])]),(0,o.Lk)("div",A,[T,(0,o.bo)((0,o.Lk)("select",{id:"city","onUpdate:modelValue":t[4]||(t[4]=e=>n.selectedCity=e)},[((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)(n.cities,(e=>((0,o.uX)(),(0,o.CE)("option",{key:e,value:e},(0,v.v_)(e),9,S)))),128))],512),[[r.u1,n.selectedCity]])]),(0,o.Lk)("div",P,[D,(0,o.bo)((0,o.Lk)("input",{type:"date",id:"startDate","onUpdate:modelValue":t[5]||(t[5]=e=>n.startDate=e)},null,512),[[r.Jo,n.startDate]])]),(0,o.Lk)("div",I,[E,(0,o.bo)((0,o.Lk)("input",{type:"time",id:"startTime","onUpdate:modelValue":t[6]||(t[6]=e=>n.startTime=e)},null,512),[[r.Jo,n.startTime]])]),(0,o.Lk)("div",X,[U,(0,o.bo)((0,o.Lk)("input",{type:"date",id:"endDate","onUpdate:modelValue":t[7]||(t[7]=e=>n.endDate=e)},null,512),[[r.Jo,n.endDate]])]),(0,o.Lk)("div",V,[j,(0,o.bo)((0,o.Lk)("input",{type:"time",id:"endTime","onUpdate:modelValue":t[8]||(t[8]=e=>n.endTime=e)},null,512),[[r.Jo,n.endTime]])]),J],32),n.results.length>0?((0,o.uX)(),(0,o.CE)("div",O,[$,(0,o.Lk)("ul",null,[((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)(n.results,(e=>((0,o.uX)(),(0,o.CE)("li",{key:e.id},(0,v.v_)(e.name)+" - "+(0,v.v_)(e.location)+" - "+(0,v.v_)(e.price)+"円/時 ",1)))),128))])])):(0,o.Q3)("",!0)])}var M=a(4335);const q=M.A.create({baseURL:"http://localhost:8000/api/",timeout:1e3,headers:{"Content-Type":"application/json"}});q.interceptors.request.use((e=>{const t=localStorage.getItem("token");return t&&(e.headers.Authorization=`Token ${t}`),e}),(e=>Promise.reject(e)));var Q=q,x={name:"HomePage",data(){return{map:null,marker:null,circle:null,isLoggedIn:!1,prefectures:[],selectedPrefecture:"",cities:[],selectedCity:"",startDate:"",endDate:"",startTime:"",endTime:"",latitude:null,longitude:null,results:[]}},async mounted(){await this.checkAuthentication(),await this.fetchPrefectures(),this.initMap()},methods:{async checkAuthentication(){const e=localStorage.getItem("token");try{const t=await Q.get("user/",{headers:{Authorization:`Token ${e}`}});console.log("API Response:",t.data),this.isLoggedIn=!0,this.name=t.data.name||"Guest"}catch(t){console.error("Failed to fetch user information",t),localStorage.removeItem("token"),this.isLoggedIn=!1}},async fetchPrefectures(){try{const e=await Q.get("/proxy_geolonia/"),t=e.data;this.prefectures=Object.keys(t).map((e=>({name:e,cities:t[e]}))),console.log("Processed Prefectures Data:",this.prefectures)}catch(e){console.error("都道府県データの取得に失敗しました:",e)}},updateCities(){const e=this.prefectures.find((e=>e.name===this.selectedPrefecture));this.cities=e?e.cities:[],this.selectedCity=""},initMap(){this.map=new google.maps.Map(this.$refs.map,{center:{lat:35.6895,lng:139.6917},zoom:12}),this.map.addListener("center_changed",(()=>{const e=this.map.getCenter();this.latitude=e.lat(),this.longitude=e.lng()}))},async getCurrentLocation(){navigator.geolocation?navigator.geolocation.getCurrentPosition((e=>{this.latitude=e.coords.latitude,this.longitude=e.coords.longitude,this.map.setCenter({lat:this.latitude,lng:this.longitude}),this.marker&&this.marker.setMap(null),this.marker=new google.maps.Marker({position:{lat:this.latitude,lng:this.longitude},map:this.map,title:"現在地"}),this.circle&&this.circle.setMap(null),this.circle=new google.maps.Circle({map:this.map,radius:5e3,fillColor:"#AA0000"}),this.circle.bindTo("center",this.marker,"position"),this.searchSitters()}),(e=>{console.error("現在地の取得に失敗しました:",e),alert("現在地の取得に失敗しました。位置情報を許可してください。")})):alert("このブラウザは位置情報取得をサポートしていません。")},async searchSitters(){try{const e=await Q.get("sitters/",{params:{location:this.selectedCity,start_date:this.startDate,end_date:this.endDate,start_time:this.startTime,end_time:this.endTime,latitude:this.latitude,longitude:this.longitude}});this.results=e.data}catch(e){console.error("検索に失敗しました:",e),alert("検索に失敗しました。再度お試しください。")}},async searchArea(){const e=this.map.getCenter();this.latitude=e.lat(),this.longitude=e.lng(),this.searchSitters()}}};const R=(0,d.A)(x,[["render",F],["__scopeId","data-v-16a789fa"]]);var z=R;const H=e=>((0,o.Qi)("data-v-f4134154"),e=e(),(0,o.jt)(),e),K={class:"register-container"},W=H((()=>(0,o.Lk)("h1",null,"新規登録",-1))),G={class:"input-group"},B=H((()=>(0,o.Lk)("label",{for:"email"},"メールアドレス:",-1))),N={class:"input-group"},Y=H((()=>(0,o.Lk)("label",{for:"name"},"名前:",-1))),Z={class:"input-group"},ee=H((()=>(0,o.Lk)("label",{for:"password"},"パスワード:",-1))),te=H((()=>(0,o.Lk)("button",{type:"submit"},"登録する",-1)));function ae(e,t,a,i,n,s){return(0,o.uX)(),(0,o.CE)("div",K,[W,(0,o.Lk)("form",{onSubmit:t[3]||(t[3]=(0,r.D$)(((...e)=>s.register&&s.register(...e)),["prevent"]))},[(0,o.Lk)("div",G,[B,(0,o.bo)((0,o.Lk)("input",{type:"email","onUpdate:modelValue":t[0]||(t[0]=e=>n.email=e),required:""},null,512),[[r.Jo,n.email]])]),(0,o.Lk)("div",N,[Y,(0,o.bo)((0,o.Lk)("input",{type:"text",id:"name","onUpdate:modelValue":t[1]||(t[1]=e=>n.name=e),required:""},null,512),[[r.Jo,n.name]])]),(0,o.Lk)("div",Z,[ee,(0,o.bo)((0,o.Lk)("input",{type:"password","onUpdate:modelValue":t[2]||(t[2]=e=>n.password=e),required:""},null,512),[[r.Jo,n.password]])]),te],32)])}var re={name:"RegisterPage",data(){return{name:"",email:"",password:""}},methods:{async register(){try{await Q.post("register/",{name:this.name,email:this.email,password:this.password}),alert("登録が成功しました！"),this.$router.push("/login")}catch(e){e.response?e.response.data.email?(console.error("Registration failed: This email is already registered."),alert("このメールアドレスは既に登録されています。別のメールアドレスを使用してください。")):(console.error("Registration failed:",e.response.data),alert("登録に失敗しました。再度お試しください。")):(console.error("Registration failed:",e.message),alert("登録に失敗しました。再度お試しください。"))}}}};const oe=(0,d.A)(re,[["render",ae],["__scopeId","data-v-f4134154"]]);var ie=oe;const ne=e=>((0,o.Qi)("data-v-f56d1370"),e=e(),(0,o.jt)(),e),se={class:"login-container"},le=ne((()=>(0,o.Lk)("h1",null,"ログイン",-1))),ue={class:"input-group"},ce=ne((()=>(0,o.Lk)("label",{for:"email"},"メールアドレス",-1))),de={class:"input-group"},pe=ne((()=>(0,o.Lk)("label",{for:"password"},"パスワード",-1))),me=ne((()=>(0,o.Lk)("button",{type:"submit",class:"login-button"},"ログイン",-1))),he={class:"register-link"};function ge(e,t,a,i,n,s){const l=(0,o.g2)("router-link");return(0,o.uX)(),(0,o.CE)("div",null,[(0,o.Lk)("div",se,[le,(0,o.Lk)("form",{onSubmit:t[2]||(t[2]=(0,r.D$)(((...e)=>s.login&&s.login(...e)),["prevent"]))},[(0,o.Lk)("div",ue,[ce,(0,o.bo)((0,o.Lk)("input",{type:"email","onUpdate:modelValue":t[0]||(t[0]=e=>n.email=e),required:""},null,512),[[r.Jo,n.email]])]),(0,o.Lk)("div",de,[pe,(0,o.bo)((0,o.Lk)("input",{type:"password","onUpdate:modelValue":t[1]||(t[1]=e=>n.password=e),required:""},null,512),[[r.Jo,n.password]])]),me],32),(0,o.Lk)("p",he,[(0,o.bF)(l,{to:"/register"},{default:(0,o.k6)((()=>[(0,o.eW)("新規登録の方はこちら")])),_:1})])])])}var fe={name:"LoginPage",data(){return{email:"",password:""}},methods:{async login(){try{const e=await Q.post("/login/",{email:this.email,password:this.password}),t=e.data.token;localStorage.setItem("token",t),this.$router.push("/")}catch(e){console.error("ログインに失敗しました:",e),alert("ログインに失敗しました。再度お試しください。")}}}};const ke=(0,d.A)(fe,[["render",ge],["__scopeId","data-v-f56d1370"]]);var ve=ke;const Le=e=>((0,o.Qi)("data-v-04fb871a"),e=e(),(0,o.jt)(),e),be={class:"sitter-search-container"},ye=Le((()=>(0,o.Lk)("h1",null,"シッター検索",-1))),Ce={class:"input-group"},_e=Le((()=>(0,o.Lk)("label",{for:"prefecture"},"都道府県",-1))),we=["value"],Ae=Le((()=>(0,o.Lk)("label",{for:"city"},"市区町村",-1))),Te=["value"],Se={class:"input-group"},Pe=Le((()=>(0,o.Lk)("label",{for:"startDate"},"開始日",-1))),De={class:"input-group"},Ie=Le((()=>(0,o.Lk)("label",{for:"startTime"},"開始時間",-1))),Ee={class:"input-group"},Xe=Le((()=>(0,o.Lk)("label",{for:"endDate"},"終了日",-1))),Ue={class:"input-group"},Ve=Le((()=>(0,o.Lk)("label",{for:"endTime"},"終了時間",-1))),je=Le((()=>(0,o.Lk)("button",{type:"submit"},"検索する",-1))),Je={key:0,class:"results"},Oe=Le((()=>(0,o.Lk)("h2",null,"検索結果",-1)));function $e(e,t,a,i,n,s){return(0,o.uX)(),(0,o.CE)("div",be,[ye,(0,o.Lk)("form",{onSubmit:t[7]||(t[7]=(0,r.D$)(((...e)=>s.searchSitters&&s.searchSitters(...e)),["prevent"]))},[(0,o.Lk)("div",Ce,[_e,(0,o.bo)((0,o.Lk)("select",{id:"prefecture","onUpdate:modelValue":t[0]||(t[0]=e=>n.selectedPrefecture=e),onChange:t[1]||(t[1]=(...e)=>s.updateCities&&s.updateCities(...e))},[((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)(n.prefectures,(e=>((0,o.uX)(),(0,o.CE)("option",{key:e.name,value:e.name},(0,v.v_)(e.name),9,we)))),128))],544),[[r.u1,n.selectedPrefecture]]),Ae,(0,o.bo)((0,o.Lk)("select",{id:"city","onUpdate:modelValue":t[2]||(t[2]=e=>n.selectedCity=e)},[((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)(n.cities,(e=>((0,o.uX)(),(0,o.CE)("option",{key:e,value:e},(0,v.v_)(e),9,Te)))),128))],512),[[r.u1,n.selectedCity]])]),(0,o.Lk)("div",Se,[Pe,(0,o.bo)((0,o.Lk)("input",{type:"date",id:"startDate","onUpdate:modelValue":t[3]||(t[3]=e=>n.startDate=e)},null,512),[[r.Jo,n.startDate]])]),(0,o.Lk)("div",De,[Ie,(0,o.bo)((0,o.Lk)("input",{type:"time",id:"startTime","onUpdate:modelValue":t[4]||(t[4]=e=>n.startTime=e)},null,512),[[r.Jo,n.startTime]])]),(0,o.Lk)("div",Ee,[Xe,(0,o.bo)((0,o.Lk)("input",{type:"date",id:"endDate","onUpdate:modelValue":t[5]||(t[5]=e=>n.endDate=e)},null,512),[[r.Jo,n.endDate]])]),(0,o.Lk)("div",Ue,[Ve,(0,o.bo)((0,o.Lk)("input",{type:"time",id:"endTime","onUpdate:modelValue":t[6]||(t[6]=e=>n.endTime=e)},null,512),[[r.Jo,n.endTime]])]),je],32),n.results.length>0?((0,o.uX)(),(0,o.CE)("div",Je,[Oe,(0,o.Lk)("ul",null,[((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)(n.results,(e=>((0,o.uX)(),(0,o.CE)("li",{key:e.id},(0,v.v_)(e.name)+" - "+(0,v.v_)(e.location)+" - "+(0,v.v_)(e.price)+"円/時 ",1)))),128))])])):(0,o.Q3)("",!0)])}var Fe={name:"SitterSearch",data(){return{prefectures:[],selectedPrefecture:"",cities:[],selectedCity:"",startDate:"",endDate:"",startTime:"",endTime:"",results:[]}},async mounted(){await this.fetchPrefectures()},methods:{async fetchPrefectures(){try{const e=await Q.get("/proxy_geolonia/"),t=e.data;this.prefectures=Object.keys(t).map((e=>({name:e,cities:t[e]}))),console.log("Processed Prefectures Data:",this.prefectures)}catch(e){console.error("都道府県データの取得に失敗しました:",e)}},updateCities(){const e=this.prefectures.find((e=>e.name===this.selectedPrefecture));this.cities=e?e.cities:[],this.selectedCity=""},async searchSitters(){const e=localStorage.getItem("token");try{const t=await Q.get("sitters/",{headers:{Authorization:`Token ${e}`},params:{location:this.selectedCity,start_date:this.startDate,end_date:this.endDate,start_time:this.startTime,end_time:this.endTime}});this.results=t.data}catch(t){console.error("検索に失敗しました:",t),alert("検索に失敗しました。再度お試しください。")}}}};const Me=(0,d.A)(Fe,[["render",$e],["__scopeId","data-v-04fb871a"]]);var qe=Me;const Qe=e=>((0,o.Qi)("data-v-8a145d90"),e=e(),(0,o.jt)(),e),xe={class:"profile-container"},Re=Qe((()=>(0,o.Lk)("h1",null,"プロフィール",-1))),ze=Qe((()=>(0,o.Lk)("label",{for:"email"},"メールアドレス:",-1))),He=Qe((()=>(0,o.Lk)("label",{for:"name"},"名前:",-1))),Ke=Qe((()=>(0,o.Lk)("button",{type:"submit"},"更新",-1))),We={key:0};function Ge(e,t,a,i,n,s){return(0,o.uX)(),(0,o.CE)("div",xe,[Re,(0,o.Lk)("form",{onSubmit:t[2]||(t[2]=(0,r.D$)(((...e)=>s.updateProfile&&s.updateProfile(...e)),["prevent"]))},[ze,(0,o.bo)((0,o.Lk)("input",{type:"email","onUpdate:modelValue":t[0]||(t[0]=e=>n.email=e),required:""},null,512),[[r.Jo,n.email]]),He,(0,o.bo)((0,o.Lk)("input",{type:"text","onUpdate:modelValue":t[1]||(t[1]=e=>n.name=e),required:""},null,512),[[r.Jo,n.name]]),Ke,n.successMessage?((0,o.uX)(),(0,o.CE)("p",We,(0,v.v_)(n.successMessage),1)):(0,o.Q3)("",!0)],32)])}var Be={name:"UserProfile",data(){return{isLoggedIn:!1,name:"",email:"",successMessage:""}},async mounted(){const e=localStorage.getItem("token");try{const t=await M.A.get("http://localhost:8000/api/user/",{headers:{Authorization:`Token ${e}`}});this.email=t.data.email,this.name=t.data.name}catch(t){console.error("プロフィール情報の取得に失敗しました:",t)}},methods:{async updateProfile(){const e=localStorage.getItem("token");try{await M.A.put("http://localhost:8000/api/user/",{email:this.email,name:this.name},{headers:{Authorization:`Token ${e}`}}),this.successMessage="プロフィールが更新されました"}catch(t){console.error("プロフィールの更新に失敗しました:",t)}}}};const Ne=(0,d.A)(Be,[["render",Ge],["__scopeId","data-v-8a145d90"]]);var Ye=Ne;const Ze=[{path:"/",name:"Home",component:z,meta:{requiresAuth:!0}},{path:"/register",name:"Register",component:ie},{path:"/login",name:"Login",component:ve},{path:"/sitter-search",name:"SitterSearch",component:qe,meta:{requiresAuth:!0}},{path:"/profile",name:"Profile",component:Ye}],et=(0,k.aE)({history:(0,k.LA)("/"),routes:Ze});et.beforeEach(((e,t,a)=>{const r=!!localStorage.getItem("token");e.matched.some((e=>e.meta.requiresAuth))&&!r?a("/login"):a()}));var tt=et;(0,r.Ef)(f).use(tt).mount("#app")}},t={};function a(r){var o=t[r];if(void 0!==o)return o.exports;var i=t[r]={exports:{}};return e[r].call(i.exports,i,i.exports,a),i.exports}a.m=e,function(){var e=[];a.O=function(t,r,o,i){if(!r){var n=1/0;for(c=0;c<e.length;c++){r=e[c][0],o=e[c][1],i=e[c][2];for(var s=!0,l=0;l<r.length;l++)(!1&i||n>=i)&&Object.keys(a.O).every((function(e){return a.O[e](r[l])}))?r.splice(l--,1):(s=!1,i<n&&(n=i));if(s){e.splice(c--,1);var u=o();void 0!==u&&(t=u)}}return t}i=i||0;for(var c=e.length;c>0&&e[c-1][2]>i;c--)e[c]=e[c-1];e[c]=[r,o,i]}}(),function(){a.d=function(e,t){for(var r in t)a.o(t,r)&&!a.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})}}(),function(){a.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}()}(),function(){a.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)}}(),function(){a.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}}(),function(){var e={524:0};a.O.j=function(t){return 0===e[t]};var t=function(t,r){var o,i,n=r[0],s=r[1],l=r[2],u=0;if(n.some((function(t){return 0!==e[t]}))){for(o in s)a.o(s,o)&&(a.m[o]=s[o]);if(l)var c=l(a)}for(t&&t(r);u<n.length;u++)i=n[u],a.o(e,i)&&e[i]&&e[i][0](),e[i]=0;return a.O(c)},r=self["webpackChunkfrontend"]=self["webpackChunkfrontend"]||[];r.forEach(t.bind(null,0)),r.push=t.bind(null,r.push.bind(r))}();var r=a.O(void 0,[504],(function(){return a(4764)}));r=a.O(r)})();
//# sourceMappingURL=app.607ef83d.js.map